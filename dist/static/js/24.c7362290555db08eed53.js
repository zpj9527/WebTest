webpackJsonp([24],{"R/Wc":function(e,a){},SldI:function(e,a,t){"use strict";Object.defineProperty(a,"__esModule",{value:!0});var r=t("BO1k"),s=t.n(r),l=t("PJh5"),i=t.n(l),c=t("mtWM"),n=t.n(c),p={name:"integral",data:function(){return{UrLHeader:this.api.api_pro_dev+"/v1/",tableData:[],checked:!0,SearchContent:"",param:{},showAdd:!1,showDeleteAndEdit:!1,rowId:"",treeData:[],value1:"",currentPage:1,pagesize:10,total:0,str_before:"",str_after:"",card_type:"",card_level:"",defaultProps:{children:"children",label:"descript"},custom_wayArr:[{code:"point",descript:"积分"},{code:"money",descript:"现金"}],idCodeArr:[]}},created:function(){this.getTreeData()},methods:{handleNodeClick:function(e){this.showAdd=!0,this.showDeleteAndEdit=!1,this.param={};var a=e.card_type,t=e.card_level;this.card_type=a,this.card_level=t,void 0!=a&&void 0!=t&&this.getData(this.currentPage,a,t)},handleSizeChange:function(){},getTreeData:function(){var e=this,a=this.UrLHeader+"customer/member/get_card_setting_tree/?code_type=MB";n.a.get(a).then(function(a){var t=a.data.data.results,r=!0,l=!1,i=void 0;try{for(var c,n=s()(t);!(r=(c=n.next()).done);r=!0){var p=c.value,d=!0,o=!1,v=void 0;try{for(var u,_=s()(p.children);!(d=(u=_.next()).done);d=!0){var m=u.value;m.card_type=p.code,m.card_level=m.code}}catch(e){o=!0,v=e}finally{try{!d&&_.return&&_.return()}finally{if(o)throw v}}}}catch(e){l=!0,i=e}finally{try{!r&&n.return&&n.return()}finally{if(l)throw i}}e.treeData=a.data.data.results}).catch(function(e){})},getData:function(e,a,t){var r=this,s=r.UrLHeader+"customer/member/get_card_point_rule_list/";n()({method:"get",url:s,params:{page:e,page_size:8,card_type:a,card_level:t}}).then(function(e){"success"==e.data.message&&(r.tableData=e.data.data.results,r.total=e.data.data.count)}).catch(function(e){})},handleInfoById:function(e){var a=this;a.showDeleteAndEdit=!0,a.showAdd=!1,a.rowId=e.id;var t=a.UrLHeader+"customer/member/get_card_point_rule_info/"+e.id+"/";n.a.get(t).then(function(e){"success"==e.data.message&&(a.param=e.data.data,a.getString(a.param.rate,":"),a.param.rate_1=a.str_before,a.param.rate_2=a.str_after,a.param.create_datetime=i()().format("YYYY-MM-DD HH:mm:ss"),a.param.modify_datetime=i()().format("YYYY-MM-DD HH:mm:ss"))})},getString:function(e,a){this.str_before=e.split(a)[0],this.str_after=void 0===e.split(a)[1]?"":e.split(a)[1]},handleEdit:function(){var e=this;if(this.validateData()){var a=this.rowId,t=this.UrLHeader+"customer/member/update_card_point_rule/"+a+"/",r=this;r.param.rate=r.param.rate_1+":"+r.param.rate_2,n.a.post(t,r.param).then(function(a){"success"==a.data.message?(r.getData(r.currentPage,r.card_type,r.card_level),r.$message({message:"保存信息成功",type:"success"}),r.showDeleteAndEdit=!1,r.showAdd=!0,r.param={}):e.$message.error("保存信息失败")})}},handleDelete:function(){var e=this,a=e.rowId,t=e.UrLHeader+"customer/member/remove_card_point_rule/"+a+"/";e.$confirm("是否进行删除操作?","提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then(function(){n.a.post(t).then(function(){e.getData(e.currentPage,e.card_type,e.card_level),e.$message({message:"删除成功",type:"success"}),e.showDeleteAndEdit=!1,e.showAdd=!0,e.param={}}).catch(function(e){})}).catch(function(){e.$message({type:"info",message:"已取消删除"})})},handleAdd:function(){if(void 0!==this.card_type&&void 0!==this.card_level){if(this.validateData()){var e=this,a=e.UrLHeader+"customer/member/add_card_point_rule/";e.param.card_type=e.card_type,e.param.card_level=e.card_level,e.param.rate=e.param.rate_1+":"+e.param.rate_2,n.a.post(a,e.param).then(function(a){e.getData(e.currentPage,e.card_type,e.card_level),e.$message({message:"添加成功",type:"success"}),e.param={}}).catch(function(e){})}}else this.$message({message:"请点击具体子节点在进行添加!",type:"warning"})},validateData:function(){return this.validateBlank(this.param.code,"代码是必填项",this)&&this.validateBlank(this.param.descript,"中文描述是必填项",this)&&this.validateBlank(this.param.descript_en,"英文描述是必填项",this)&&this.validateBlank(this.param.rate_1,"积分比例是必填项",this)&&this.validateBlank(this.param.rate_2,"积分比例是必填项",this)&&this.validateNAN(this.param.rate_1,"积分比例是数字",this)&&this.validateNAN(this.param.rate_2,"积分比例是数字",this)},validateBlank:function(e,a,t,r){return a?""===e||null===e||void 0===e?(t.$message({message:a,type:"error"}),!1):(r&&t.$message({message:r,type:"success"}),!0):!(""===e||null===e||void 0===e)},validateNAN:function(e,a,t,r){if(""===e||null===e||void 0===e)return!0;var s=/^(\-|\+)?\d+(\.\d+)?$/;return a?s.test(e)?(r&&t.$message({message:r,type:"success"}),!0):(t.$message({message:a,type:"error"}),!1):s.test(e)}}},d={render:function(){var e=this,a=e.$createElement,t=e._self._c||a;return t("div",{staticClass:"integral"},[t("div",{staticClass:"tableShow"},[t("div",{staticClass:"leftShow pull-left"},[t("el-tree",{ref:"tree",staticStyle:{background:"#f7f7f7"},attrs:{data:e.treeData,props:e.defaultProps},on:{"node-click":e.handleNodeClick}})],1),e._v(" "),t("div",{staticClass:"table pull-right",staticStyle:{width:"75%"}},[t("el-table",{staticStyle:{width:"100%"},attrs:{data:e.tableData,"header-cell-style":{background:"#BFCAD1",color:"#68819E"}},on:{"row-click":e.handleInfoById}},[t("el-table-column",{attrs:{type:"index",width:"55",label:"编号"}}),e._v(" "),t("el-table-column",{attrs:{prop:"code",label:"积分规则代码"}}),e._v(" "),t("el-table-column",{attrs:{prop:"descript",label:"中文描述"}}),e._v(" "),t("el-table-column",{attrs:{prop:"descript_en",label:"英文描述"}}),e._v(" "),t("el-table-column",{attrs:{prop:"rate",label:"积分比例"}})],1),e._v(" "),t("el-pagination",{attrs:{"current-page":e.currentPage,"page-size":e.pagesize,layout:"total, prev, pager, next, jumper",total:e.total},on:{"size-change":e.handleSizeChange,"current-change":e.getData}})],1)]),e._v(" "),t("p",{staticClass:"iconLogo"},[e._v("会员卡级别")]),e._v(" "),t("div",{staticClass:"classDiv"},[t("div",{staticClass:"classCell"},[t("div",{staticClass:"inputCell"},[t("p",[e._v("代码：")]),e._v(" "),t("el-input",{staticStyle:{width:"400px"},attrs:{placeholder:"请输入内容"},model:{value:e.param.code,callback:function(a){e.$set(e.param,"code",a)},expression:"param.code"}})],1),e._v(" "),t("div",{staticClass:"inputCell"},[t("p",[e._v("中文描述 ：")]),e._v(" "),t("el-input",{staticStyle:{width:"400px"},attrs:{placeholder:"请输入内容"},model:{value:e.param.descript,callback:function(a){e.$set(e.param,"descript",a)},expression:"param.descript"}})],1),e._v(" "),t("div",{staticClass:"inputCell"},[t("p",[e._v("英文描述：")]),e._v(" "),t("el-input",{staticStyle:{width:"400px"},attrs:{placeholder:"请输入内容"},model:{value:e.param.descript_en,callback:function(a){e.$set(e.param,"descript_en",a)},expression:"param.descript_en"}})],1),e._v(" "),t("div",{staticClass:"inputCell"},[t("p",[e._v("积分比例：")]),e._v(" "),t("el-input",{staticStyle:{width:"190px"},attrs:{placeholder:"请输入内容"},model:{value:e.param.rate_1,callback:function(a){e.$set(e.param,"rate_1","string"==typeof a?a.trim():a)},expression:"param.rate_1"}}),e._v(" "),t("span",{staticStyle:{"margin-left":"4px","margin-right":"4px"}},[e._v(":")]),e._v(" "),t("el-input",{staticStyle:{width:"190px"},attrs:{placeholder:"请输入内容"},model:{value:e.param.rate_2,callback:function(a){e.$set(e.param,"rate_2","string"==typeof a?a.trim():a)},expression:"param.rate_2"}})],1),e._v(" "),t("div",{staticClass:"inputCell"},[t("p",[e._v("起步金额：")]),e._v(" "),t("el-input",{staticStyle:{width:"400px"},attrs:{placeholder:"请输入内容"},model:{value:e.param.base,callback:function(a){e.$set(e.param,"base",a)},expression:"param.base"}})],1),e._v(" "),t("div",{staticClass:"inputCell"},[t("p",[e._v("消费酒店：")]),e._v(" "),t("el-input",{staticStyle:{width:"400px"},attrs:{placeholder:"请输入内容"},model:{value:e.param.consume_hotel,callback:function(a){e.$set(e.param,"consume_hotel",a)},expression:"param.consume_hotel"}})],1),e._v(" "),t("div",{staticClass:"inputCell"},[t("p",[e._v("来源：")]),e._v(" "),t("el-input",{staticStyle:{width:"400px"},attrs:{placeholder:"请输入内容"},model:{value:e.param.src,callback:function(a){e.$set(e.param,"src",a)},expression:"param.src"}})],1),e._v(" "),t("div",{staticClass:"inputCell"},[t("p",[e._v("渠道：")]),e._v(" "),t("el-input",{staticStyle:{width:"400px"},attrs:{placeholder:"请输入内容"},model:{value:e.param.channel,callback:function(a){e.$set(e.param,"channel",a)},expression:"param.channel"}})],1),e._v(" "),t("div",{staticClass:"inputCell"},[t("p",[e._v("房价码：")]),e._v(" "),t("el-input",{staticStyle:{width:"400px"},attrs:{placeholder:"请输入内容"},model:{value:e.param.rate_code,callback:function(a){e.$set(e.param,"rate_code",a)},expression:"param.rate_code"}})],1),e._v(" "),t("div",{staticClass:"inputCell"},[t("p",[e._v("费用类别：")]),e._v(" "),t("el-input",{staticStyle:{width:"400px"},attrs:{placeholder:"请输入内容"},model:{value:e.param.fee_code,callback:function(a){e.$set(e.param,"fee_code",a)},expression:"param.fee_code"}})],1)]),e._v(" "),t("div",{staticClass:"classCell"},[t("div",{staticClass:"inputCell"},[t("p",[e._v("账务发生日期：")]),e._v(" "),t("el-date-picker",{staticStyle:{width:"400px"},attrs:{type:"date",placeholder:"选择日期"},model:{value:e.value1,callback:function(a){e.value1=a},expression:"value1"}})],1),e._v(" "),t("div",{staticClass:"inputCell"},[t("p",[e._v("有效期起：")]),e._v(" "),t("el-date-picker",{staticStyle:{width:"400px"},attrs:{type:"date",placeholder:"选择日期"},model:{value:e.param.date_begin,callback:function(a){e.$set(e.param,"date_begin",a)},expression:"param.date_begin"}})],1),e._v(" "),t("div",{staticClass:"inputCell"},[t("p",[e._v("有效期止：")]),e._v(" "),t("el-date-picker",{staticStyle:{width:"400px"},attrs:{type:"date",placeholder:"选择日期"},model:{value:e.param.date_end,callback:function(a){e.$set(e.param,"date_end",a)},expression:"param.date_end"}})],1),e._v(" "),t("div",{staticClass:"inputCell"},[t("p",[e._v("截断方式：")]),e._v(" "),t("el-input",{staticStyle:{width:"400px"},attrs:{placeholder:"请输入内容"},model:{value:e.param.truncate,callback:function(a){e.$set(e.param,"truncate",a)},expression:"param.truncate"}})],1),e._v(" "),t("div",{staticClass:"inputCell"},[t("p",[e._v("开卡酒店：")]),e._v(" "),t("el-input",{staticStyle:{width:"400px"},attrs:{placeholder:"请输入内容"},model:{value:e.param.card_produce_hotel,callback:function(a){e.$set(e.param,"card_produce_hotel",a)},expression:"param.card_produce_hotel"}})],1),e._v(" "),t("div",{staticClass:"inputCell"},[t("p",[e._v("消费日期：")]),e._v(" "),t("el-date-picker",{staticStyle:{width:"400px"},attrs:{type:"date",placeholder:"选择日期"},model:{value:e.value1,callback:function(a){e.value1=a},expression:"value1"}})],1),e._v(" "),t("div",{staticClass:"inputCell"},[t("p",[e._v("市场：")]),e._v(" "),t("el-input",{staticStyle:{width:"400px"},attrs:{placeholder:"请输入内容"},model:{value:e.param.market,callback:function(a){e.$set(e.param,"market",a)},expression:"param.market"}})],1),e._v(" "),t("div",{staticClass:"inputCell"},[t("p",[e._v("预订渠道：")]),e._v(" "),t("el-input",{staticStyle:{width:"400px"},attrs:{placeholder:"请输入内容"},model:{value:e.param.rsv_type,callback:function(a){e.$set(e.param,"rsv_type",a)},expression:"param.rsv_type"}})],1),e._v(" "),t("div",{staticClass:"inputCell"},[t("p",[e._v("房类：")]),e._v(" "),t("el-select",{staticStyle:{width:"400px"},model:{value:e.param.room_type,callback:function(a){e.$set(e.param,"room_type",a)},expression:"param.room_type"}},e._l(e.idCodeArr,function(e,a){return t("el-option",{key:a,attrs:{label:e.descript,value:e.code}})}),1)],1),e._v(" "),t("div",{staticClass:"inputCell"},[t("p",[e._v("付款码：")]),e._v(" "),t("el-input",{staticStyle:{width:"400px"},attrs:{placeholder:"请输入内容"},model:{value:e.param.pay_code,callback:function(a){e.$set(e.param,"pay_code",a)},expression:"param.pay_code"}})],1)]),e._v(" "),t("div",{staticClass:"classCell pull-right",staticStyle:{width:"15%","margin-top":"5%"}},[t("p",{staticClass:"cellp"},[e._v("创建人:"+e._s(e.param.create_user))]),e._v(" "),t("p",{staticClass:"cellp"},[e._v("创建日期:"+e._s(e.param.create_datetime))]),e._v(" "),t("p",{staticClass:"cellp"},[e._v("修改人:"+e._s(e.param.modify_user))]),e._v(" "),t("p",{staticClass:"cellp"},[e._v("修改日期:"+e._s(e.param.modify_datetime))]),e._v(" "),t("div",[t("el-button",{directives:[{name:"show",rawName:"v-show",value:e.showAdd,expression:"showAdd"}],attrs:{type:"primary"},on:{click:function(a){e.handleAdd()}}},[e._v("添加")]),e._v(" "),t("el-button",{directives:[{name:"show",rawName:"v-show",value:e.showDeleteAndEdit,expression:"showDeleteAndEdit"}],attrs:{type:"primary"},on:{click:function(a){e.handleDelete()}}},[e._v("删除")]),e._v(" "),t("el-button",{directives:[{name:"show",rawName:"v-show",value:e.showDeleteAndEdit,expression:"showDeleteAndEdit"}],attrs:{type:"primary"},on:{click:function(a){e.handleEdit()}}},[e._v("保存")])],1)])])])},staticRenderFns:[]};var o=t("VU/8")(p,d,!1,function(e){t("R/Wc")},"data-v-82620c98",null);a.default=o.exports}});